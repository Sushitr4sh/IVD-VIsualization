const inputArray = [
  "2708-6;P00002;2023-11-22 16:07:00.000;;;UTC+0700;92.0;99.0;88.0;88.0;0afb8438-cdb7-45f5-b749-f446b054faaf",
  "2708-6;P00002;2023-11-22 21:06:00.000;;;UTC+0700;96.0;99.0;95.0;93.0;2f9b518d-ebcc-41b3-b2a4-4b9862d2194e",
  "2708-6;P00002;2023-11-22 22:14:00.000;;;UTC+0700;88.0;93.0;88.0;81.0;b674f95f-79a5-40f8-9f58-8b4ea9aebc40",
  "2708-6;P00002;2023-11-23 15:49:00.000;;;UTC+0700;95.0;99.0;89.0;84.0;7e53fb0a-3b87-4600-a681-430de94d6b7b",
  "2708-6;P00002;2023-11-23 22:38:00.000;;;UTC+0700;97.0;100.0;93.0;85.0;0b10bf27-1be0-4ea1-9269-1c21da24982b",
  "2708-6;P00002;2023-11-24 02:59:00.000;;;UTC+0700;94.0;99.0;85.0;89.0;46cdb2b1-0c16-4117-9e32-04fcb4a889e2",
  "2708-6;P00002;2023-11-24 16:44:00.000;;;UTC+0700;96.0;99.0;89.0;96.0;86c9ef32-64e7-421b-8c73-e930b7793aa8",
  "2708-6;P00002;2023-11-24 21:36:00.000;;;UTC+0700;95.0;99.0;91.0;85.0;3d45042b-36a9-4636-a163-41ed7a6da093",
  "2708-6;P00002;2023-11-25 15:36:00.000;;;UTC+0700;98.0;100.0;97.0;86.0;7ce2087b-a650-4035-ba7a-33c1740ef8db",
  "2708-6;P00002;2023-11-26 03:24:00.000;;;UTC+0700;97.0;100.0;94.0;85.0;c4b8ea5d-aacd-4258-b8fd-20805e9981a3",
  "2708-6;P00002;2023-11-27 19:20:00.000;;;UTC+0700;96.0;99.0;91.0;97.0;f57c149f-c0a6-42a5-90b9-c4b4a92b6254",
  "2708-6;P00002;2023-11-28 13:59:00.000;;;UTC+0700;91.0;97.0;79.0;96.0;a95562ce-8af2-4e79-be74-4aff210e9f82",
  "2708-6;P00002;2023-11-28 17:23:00.000;;;UTC+0700;96.0;100.0;91.0;88.0;dd8b980d-fd67-4f42-8e9a-7e530a0448e1",
  "2708-6;P00002;2023-11-28 23:22:00.000;;;UTC+0700;97.0;99.0;97.0;93.0;e88dd6bb-63e1-451d-adf6-ae01e6a2aa14",
  "2708-6;P00002;2023-11-29 04:52:00.000;;;UTC+0700;90.0;98.0;87.0;99.0;45e9458d-66ee-48b6-b033-52a4b1a75231",
  "2708-6;P00002;2023-11-29 16:49:00.000;;;UTC+0700;95.0;100.0;92.0;82.0;cf04fc33-22bc-479b-a01b-036a0701c973",
  "2708-6;P00002;2023-11-29 20:44:00.000;;;UTC+0700;95.0;99.0;92.0;92.0;5ea0d27f-d3c7-4a02-800c-8078c42ab150",
];

const resultArray = [];

inputArray.forEach((entry) => {
  const [
    _,
    __,
    dateOld,
    ____,
    _____,
    ______,
    spo2,
    ________,
    _________,
    __________,
    ___________,
    ____________,
    _____________,
    ______________,
    _______________,
  ] = entry.split(";");

  const [date, time] = dateOld.split(" ");

  if (
    resultArray.length === 0 ||
    resultArray[resultArray.length - 1].date !== date
  ) {
    resultArray.push({
      date,
      time: [time],
      rr: [null],
      spo2: [parseInt(spo2)],
    });
  } else {
    resultArray.forEach((dateLoop) => {
      if (dateLoop.date === date) {
        dateLoop.time.push(time);
        dateLoop.rr.push(null);
        dateLoop.spo2.push(parseInt(spo2));
      }
    });
  }
});

/* db.patients.updateOne(
  { patientId: "P00002" },
  {
    $push: {
      rrSpo2History: {
        $each: [
          {
            date: "2023-11-22",
            time: ["16:07:00.000", "21:06:00.000", "22:14:00.000"],
            rr: [null, null, null],
            spo2: [92, 96, 88],
          },
          {
            date: "2023-11-23",
            time: ["15:49:00.000", "22:38:00.000"],
            rr: [null, null],
            spo2: [95, 97],
          },
          {
            date: "2023-11-24",
            time: ["02:59:00.000", "16:44:00.000", "21:36:00.000"],
            rr: [null, null, null],
            spo2: [94, 96, 95],
          },
          {
            date: "2023-11-25",
            time: ["15:36:00.000"],
            rr: [null],
            spo2: [98],
          },
          {
            date: "2023-11-26",
            time: ["03:24:00.000"],
            rr: [null],
            spo2: [97],
          },
          {
            date: "2023-11-27",
            time: ["19:20:00.000"],
            rr: [null],
            spo2: [96],
          },
          {
            date: "2023-11-28",
            time: ["13:59:00.000", "17:23:00.000", "23:22:00.000"],
            rr: [null, null, null],
            spo2: [91, 96, 97],
          },
          {
            date: "2023-11-29",
            time: ["04:52:00.000", "16:49:00.000", "20:44:00.000"],
            rr: [null, null, null],
            spo2: [90, 95, 95],
          },
        ],
      },
    },
  }
); */

console.log(resultArray);
